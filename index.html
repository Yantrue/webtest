<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Presentasi Video</title>
  <style>
  body { font-family: Arial; padding: 20px; max-width: 700px; margin: auto; }
  iframe {
    width: 100%;
    aspect-ratio: 16 / 9; /* menjaga rasio */
    border: none;
  }
  #thumbnail {
    max-width: 100%;
    margin-top: 10px;
  }
  #desc {
    white-space: pre-wrap; /* supaya enter di deskripsi tampil */
    margin-top: 15px;
  }
  textarea {
    width: 100%;
    box-sizing: border-box;
    font-size: 1rem;
    padding: 10px;
    margin-top: 10px;
    resize: none; /* kita akan atur resize otomatis dengan JS */
    min-height: 80px;
  }
</style>
</head>
<body>

  <h1>üìö Dashboard Presentasi Video</h1>

  <div class="input-container">
    <input type="text" id="judul-presentasi" placeholder="Judul Halaman Presentasi" />
    <input type="text" id="youtube-link" placeholder="Link Video YouTube" />
    <textarea id="video-desc" placeholder="Deskripsi Video"></textarea>
    <button onclick="tambahVideo()">‚ûï Tambahkan Presentasi</button>
  </div>

  <h2>üìã Daftar Presentasi:</h2>
  <div id="video-list"></div>

  <script>
    function getVideoId(url) {
      const match = url.match(/(?:youtu\.be\/|youtube\.com\/(?:watch\?v=|embed\/))([\w-]{11})/);
      return match ? match[1] : null;
    }

    let daftarVideo = JSON.parse(localStorage.getItem("daftar_presentasi")) || [];

    async function tambahVideo() {
      const judul = document.getElementById("judul-presentasi").value.trim();
      const link = document.getElementById("youtube-link").value.trim();
      const deskripsi = document.getElementById("video-desc").value.trim();
      const videoId = getVideoId(link);

      if (!judul || !videoId) {
        alert("Judul dan link video harus diisi dengan benar.");
        return;
      }

      try {
        const res = await fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${videoId}`);
        const data = await res.json();

        if (!data.title) throw new Error("Data video tidak ditemukan");

        const videoBaru = {
          id: videoId,
          judulHalaman: judul,
          title: data.title,
          channel: data.author_name,
          thumbnail: data.thumbnail_url,
          deskripsi
        };

        daftarVideo.push(videoBaru);
        localStorage.setItem("daftar_presentasi", JSON.stringify(daftarVideo));

        document.getElementById("judul-presentasi").value = "";
        document.getElementById("youtube-link").value = "";
        document.getElementById("video-desc").value = "";
        renderDaftar();

      } catch (error) {
        alert("Gagal mengambil data video, coba lagi.");
      }
    }

    function hapusVideo(id) {
      if (!confirm("Yakin ingin menghapus presentasi ini?")) return;
      daftarVideo = daftarVideo.filter(v => v.id !== id);
      localStorage.setItem("daftar_presentasi", JSON.stringify(daftarVideo));
      renderDaftar();
    }

    function renderDaftar() {
      const container = document.getElementById("video-list");
      container.innerHTML = "";

      if (daftarVideo.length === 0) {
        container.innerHTML = "<p>Belum ada presentasi yang ditambahkan.</p>";
        return;
      }

      daftarVideo.forEach(video => {
        const div = document.createElement("div");
        div.className = "video-card";
        div.innerHTML = `
          <button class="hapus-btn" onclick="hapusVideo('${video.id}')">‚úñ</button>
          <h3>${video.judulHalaman}</h3>
          <a href="video.html?v=${video.id}">
            <img src="${video.thumbnail}" alt="thumbnail" />
            <br />
            <strong>${video.title}</strong><br />
            <em>Dari: ${video.channel}</em>
          </a>
          <p>${video.deskripsi}</p>
          <p>‚û°Ô∏è Klik untuk buka halaman video</p>
        `;
        container.appendChild(div);
      });
    }

    renderDaftar();
  </script>

</body>
</html>
